<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个人主页 | Portfolio</title>
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 React 和 ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- 引入 Babel 用于解析 JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- 引入 Lucide React 图标库 -->
    <script src="https://unpkg.com/lucide-react@latest/dist/lucide-react.js"></script>
    <!-- 引入 Markdown 渲染库 (用于 AI 回复的格式化) -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        /* 自定义一些平滑滚动的样式 */
        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
            background-color: #f8fafc;
            /* Slate-50 */
        }

        .fade-in-up {
            animation: fadeInUp 0.8s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 隐藏滚动条但保留功能 */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* 打字机光标动画 */
        .cursor-blink {
            animation: blink 1s step-end infinite;
        }

        @keyframes blink {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0;
            }
        }

        /* Markdown 样式微调 */
        .prose p {
            margin-bottom: 0.5em;
        }

        .prose ul {
            list-style-type: disc;
            padding-left: 1.2em;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { Mail, Github, Linkedin, MapPin, GraduationCap, Briefcase, Microscope, ChevronDown, ExternalLink, BookOpen, MessageSquare, X, Send, Sparkles, Loader2, Bot } = lucideReact;

        // ==========================================
        //  配置与数据
        // ==========================================

        // API Key (由运行环境注入)
        const apiKey = "";

        const portfolioData = {
            personal: {
                name: "李 明",
                title: "人工智能与计算机视觉研究员",
                tagline: "致力于探索深度学习在医疗影像分析中的应用边界。",
                location: "中国，北京",
                email: "liming@example.com",
                github: "https://github.com",
                linkedin: "https://linkedin.com",
                avatar: "https://api.dicebear.com/7.x/notionists/svg?seed=Felix&backgroundColor=e2e8f0"
            },
            about: "你好！我是一名充满热情的研究员，目前在攻读计算机科学博士学位。我的主要兴趣在于如何利用生成式对抗网络（GANs）来提高低资源环境下的医疗诊断准确率。闲暇时间，我喜欢摄影和开源贡献。",
            experience: [
                {
                    role: "高级算法实习生",
                    company: "未来科技研究院",
                    period: "2023.06 - 至今",
                    description: "负责大规模预训练模型的微调工作，优化了图像分割算法，使推理速度提升了 30%。"
                },
                {
                    role: "研究助理",
                    company: "北京大学人工智能实验室",
                    period: "2021.09 - 2023.05",
                    description: "参与国家自然科学基金项目，发表顶级会议论文一篇 (CVPR)，主要研究方向为少样本学习。"
                }
            ],
            research: [
                {
                    title: "自监督学习在MRI影像中的应用",
                    tags: ["深度学习", "医疗影像", "Python"],
                    summary: "提出了一种新的自监督预训练策略，显著降低了对标注数据的依赖。"
                },
                {
                    title: "基于Transformer的实时目标检测",
                    tags: ["计算机视觉", "边缘计算"],
                    summary: "针对移动端设备优化的轻量级Transformer模型，实现了实时的物体识别能力。"
                },
                {
                    title: "多模态情感分析系统",
                    tags: ["NLP", "多模态"],
                    summary: "结合文本和面部表情数据，构建了一个高精度的情感识别交互系统。"
                }
            ]
        };

        // ==========================================
        //  Gemini API 工具函数
        // ==========================================

        const callGemini = async (prompt, systemInstruction = "") => {
            try {
                const response = await fetch(
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,
                    {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{ text: prompt }]
                            }],
                            systemInstruction: {
                                parts: [{ text: systemInstruction }]
                            }
                        }),
                    }
                );

                if (!response.ok) {
                    throw new Error(`API call failed: ${response.statusText}`);
                }

                const data = await response.json();
                return data.candidates?.[0]?.content?.parts?.[0]?.text || "抱歉，我现在无法回答，请稍后再试。";
            } catch (error) {
                console.error("Gemini API Error:", error);
                return "抱歉，网络连接似乎有点问题，请稍后再试。";
            }
        };

        // ==========================================
        //  UI 组件
        // ==========================================

        const SectionTitle = ({ icon: Icon, title }) => (
            <div className="flex items-center gap-2 mb-6">
                <div className="p-2 bg-blue-100 text-blue-600 rounded-lg">
                    <Icon size={20} />
                </div>
                <h2 className="text-2xl font-bold text-slate-800">{title}</h2>
            </div>
        );

        const Card = ({ children, className = "" }) => (
            <div className={`bg-white rounded-2xl p-6 shadow-sm border border-slate-100 hover:shadow-lg hover:border-blue-100 transition-all duration-300 ${className}`}>
                {children}
            </div>
        );

        const Badge = ({ text }) => (
            <span className="px-3 py-1 text-xs font-medium text-blue-600 bg-blue-50 rounded-full border border-blue-100">
                {text}
            </span>
        );

        // --- AI 研究解释组件 ---
        const ResearchCard = ({ item }) => {
            const [explanation, setExplanation] = useState(null);
            const [isLoading, setIsLoading] = useState(false);
            const [showExplanation, setShowExplanation] = useState(false);

            const handleExplain = async () => {
                if (explanation) {
                    setShowExplanation(!showExplanation);
                    return;
                }

                setIsLoading(true);
                setShowExplanation(true); // Show container immediately to show loading state

                const prompt = `请用通俗易懂的中文（非专业人士也能听懂的语言），简要解释一下这项研究：“${item.title}”。目前的研究摘要是：“${item.summary}”。请控制在100字以内。`;

                const result = await callGemini(prompt);
                setExplanation(result);
                setIsLoading(false);
            };

            return (
                <Card className="flex flex-col h-full group relative overflow-hidden">
                    <div className="flex justify-between items-start mb-4">
                        <h3 className="text-lg font-bold text-slate-800 group-hover:text-blue-600 transition-colors">
                            {item.title}
                        </h3>
                        <ExternalLink size={18} className="text-slate-300 group-hover:text-blue-500 transition-colors" />
                    </div>
                    <p className="text-slate-600 mb-6 flex-grow">
                        {item.summary}
                    </p>

                    {/* AI Explanation Area */}
                    {showExplanation && (
                        <div className="mb-4 p-3 bg-indigo-50 rounded-lg border border-indigo-100 text-sm text-indigo-800 animate-in fade-in zoom-in duration-300">
                            <div className="flex items-center gap-2 mb-2 font-semibold text-indigo-600">
                                <Sparkles size={14} />
                                <span>AI 速读</span>
                            </div>
                            {isLoading ? (
                                <div className="flex items-center gap-2 text-indigo-400">
                                    <Loader2 size={14} className="animate-spin" />
                                    正在生成通俗解释...
                                </div>
                            ) : (
                                <div dangerouslySetInnerHTML={{ __html: marked.parse(explanation) }} className="prose prose-sm max-w-none text-indigo-900 leading-relaxed" />
                            )}
                        </div>
                    )}

                    <div className="flex flex-wrap items-center justify-between mt-auto pt-4 border-t border-slate-50 gap-2">
                        <div className="flex flex-wrap gap-2">
                            {item.tags.map((tag, i) => (
                                <Badge key={i} text={tag} />
                            ))}
                        </div>
                        <button
                            onClick={handleExplain}
                            className="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-indigo-600 bg-indigo-50 hover:bg-indigo-100 rounded-full transition-colors"
                        >
                            <Sparkles size={12} />
                            {explanation ? (showExplanation ? "收起解释" : "查看解释") : "AI 速读"}
                        </button>
                    </div>
                </Card>
            );
        };

        // --- AI 聊天组件 ---
        const ChatWidget = () => {
            const [isOpen, setIsOpen] = useState(false);
            const [messages, setMessages] = useState([
                { role: 'assistant', text: `你好！我是 ${portfolioData.personal.name} 的 AI 助手。你可以问我关于他的研究、经历或技能的问题。` }
            ]);
            const [input, setInput] = useState("");
            const [isTyping, setIsTyping] = useState(false);
            const messagesEndRef = useRef(null);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages, isOpen]);

            const handleSend = async (e) => {
                e.preventDefault();
                if (!input.trim()) return;

                const userMessage = { role: 'user', text: input };
                setMessages(prev => [...prev, userMessage]);
                setInput("");
                setIsTyping(true);

                // Prepare context from portfolio data
                const context = JSON.stringify(portfolioData);
                const systemPrompt = `你是一个个人主页的 AI 助手。你的名字叫 "AI 助手"。
                你的任务是根据以下的个人资料（JSON 格式）回答访客的问题。
                
                资料：
                ${context}
                
                规则：
                1. 语气要专业、热情、礼貌。
                2. 只回答与此人（${portfolioData.personal.name}）相关的问题。如果用户问无关问题，礼貌拒绝。
                3. 回答要简洁明了。
                4. 请用中文回答。
                5. 如果资料里没有答案，就诚实地说不知道，并建议用户通过邮件联系。
                `;

                const aiResponseText = await callGemini(userMessage.text, systemPrompt);

                setMessages(prev => [...prev, { role: 'assistant', text: aiResponseText }]);
                setIsTyping(false);
            };

            return (
                <div className="fixed bottom-6 right-6 z-50 flex flex-col items-end pointer-events-none">
                    {/* Chat Window */}
                    {isOpen && (
                        <div className="pointer-events-auto mb-4 w-[350px] max-w-[calc(100vw-48px)] h-[500px] max-h-[70vh] bg-white rounded-2xl shadow-2xl border border-slate-200 flex flex-col overflow-hidden animate-in slide-in-from-bottom-10 fade-in duration-300">
                            {/* Header */}
                            <div className="bg-slate-900 p-4 flex justify-between items-center text-white">
                                <div className="flex items-center gap-2">
                                    <div className="p-1.5 bg-indigo-500 rounded-lg">
                                        <Bot size={18} className="text-white" />
                                    </div>
                                    <div>
                                        <h3 className="font-semibold text-sm">Ask AI about Me</h3>
                                        <p className="text-[10px] text-slate-400 flex items-center gap-1">
                                            <span className="w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"></span>
                                            Powered by Gemini
                                        </p>
                                    </div>
                                </div>
                                <button onClick={() => setIsOpen(false)} className="text-slate-400 hover:text-white transition-colors">
                                    <X size={20} />
                                </button>
                            </div>

                            {/* Messages */}
                            <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50">
                                {messages.map((msg, idx) => (
                                    <div key={idx} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                                        <div className={`max-w-[85%] rounded-2xl px-4 py-3 text-sm shadow-sm ${msg.role === 'user'
                                                ? 'bg-blue-600 text-white rounded-br-none'
                                                : 'bg-white text-slate-700 border border-slate-100 rounded-bl-none'
                                            }`}>
                                            {msg.role === 'assistant' ? (
                                                <div dangerouslySetInnerHTML={{ __html: marked.parse(msg.text) }} className="prose prose-sm max-w-none dark:prose-invert" />
                                            ) : (
                                                msg.text
                                            )}
                                        </div>
                                    </div>
                                ))}
                                {isTyping && (
                                    <div className="flex justify-start">
                                        <div className="bg-white border border-slate-100 rounded-2xl rounded-bl-none px-4 py-3 shadow-sm">
                                            <div className="flex gap-1">
                                                <span className="w-2 h-2 bg-slate-400 rounded-full animate-bounce" style={{ animationDelay: '0ms' }}></span>
                                                <span className="w-2 h-2 bg-slate-400 rounded-full animate-bounce" style={{ animationDelay: '150ms' }}></span>
                                                <span className="w-2 h-2 bg-slate-400 rounded-full animate-bounce" style={{ animationDelay: '300ms' }}></span>
                                            </div>
                                        </div>
                                    </div>
                                )}
                                <div ref={messagesEndRef} />
                            </div>

                            {/* Input */}
                            <form onSubmit={handleSend} className="p-3 bg-white border-t border-slate-100">
                                <div className="relative">
                                    <input
                                        type="text"
                                        value={input}
                                        onChange={(e) => setInput(e.target.value)}
                                        placeholder="问点什么..."
                                        className="w-full pl-4 pr-12 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all placeholder:text-slate-400"
                                    />
                                    <button
                                        type="submit"
                                        disabled={!input.trim() || isTyping}
                                        className="absolute right-2 top-1/2 -translate-y-1/2 p-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:hover:bg-blue-600 transition-colors"
                                    >
                                        <Send size={16} />
                                    </button>
                                </div>
                            </form>
                        </div>
                    )}

                    {/* Floating Toggle Button */}
                    <button
                        onClick={() => setIsOpen(!isOpen)}
                        className="pointer-events-auto group relative flex items-center justify-center w-14 h-14 bg-slate-900 text-white rounded-full shadow-lg hover:bg-blue-600 hover:scale-110 hover:-rotate-6 transition-all duration-300 active:scale-95"
                    >
                        {isOpen ? (
                            <X size={24} />
                        ) : (
                            <>
                                <MessageSquare size={24} className="group-hover:opacity-0 transition-opacity duration-300 absolute" />
                                <Sparkles size={24} className="opacity-0 group-hover:opacity-100 transition-opacity duration-300 absolute" />
                                {/* Notification Dot */}
                                <span className="absolute top-0 right-0 w-4 h-4 bg-red-500 rounded-full border-2 border-white"></span>
                            </>
                        )}
                    </button>
                </div>
            );
        };

        // ==========================================
        //  主应用组件
        // ==========================================

        const App = () => {
            const [scrolled, setScrolled] = useState(false);

            useEffect(() => {
                const handleScroll = () => {
                    setScrolled(window.scrollY > 50);
                };
                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);

            return (
                <div className="min-h-screen text-slate-600 selection:bg-blue-100 selection:text-blue-700 relative">

                    {/* 顶部导航栏 */}
                    <nav className={`fixed top-0 w-full z-40 transition-all duration-300 ${scrolled ? 'bg-white/80 backdrop-blur-md shadow-sm py-3' : 'bg-transparent py-5'}`}>
                        <div className="max-w-5xl mx-auto px-6 flex justify-between items-center">
                            <span className="font-bold text-xl text-slate-800 tracking-tight">
                                {portfolioData.personal.name}
                            </span>
                            <div className="flex gap-6 text-sm font-medium text-slate-500 hidden md:flex">
                                <a href="#about" className="hover:text-blue-600 transition-colors">简介</a>
                                <a href="#experience" className="hover:text-blue-600 transition-colors">经历</a>
                                <a href="#research" className="hover:text-blue-600 transition-colors">研究</a>
                                <a href="#contact" className="hover:text-blue-600 transition-colors">联系</a>
                            </div>
                        </div>
                    </nav>

                    {/* Header / Hero Section */}
                    <header className="pt-32 pb-20 px-6 relative overflow-hidden">
                        {/* 背景装饰 */}
                        <div className="absolute top-0 left-1/2 -translate-x-1/2 w-full h-full max-w-7xl -z-10 pointer-events-none">
                            <div className="absolute top-20 left-10 w-72 h-72 bg-blue-200/20 rounded-full blur-3xl mix-blend-multiply animate-blob"></div>
                            <div className="absolute top-40 right-10 w-72 h-72 bg-purple-200/20 rounded-full blur-3xl mix-blend-multiply animate-blob" style={{ animationDelay: "2s" }}></div>
                            <div className="absolute -bottom-8 left-1/2 w-72 h-72 bg-pink-200/20 rounded-full blur-3xl mix-blend-multiply animate-blob" style={{ animationDelay: "4s" }}></div>
                        </div>

                        <div className="max-w-3xl mx-auto text-center fade-in-up" style={{ animationDelay: '0.1s' }}>
                            <div className="mb-8 relative inline-block group">
                                <div className="absolute inset-0 bg-gradient-to-tr from-blue-300 to-purple-300 rounded-full blur-2xl opacity-40 group-hover:opacity-60 transition-opacity duration-500"></div>
                                <img
                                    src={portfolioData.personal.avatar}
                                    alt="Avatar"
                                    className="relative w-32 h-32 md:w-40 md:h-40 rounded-full border-4 border-white shadow-xl mx-auto object-cover transform group-hover:scale-105 transition-transform duration-500"
                                />
                                <div className="absolute bottom-2 right-2 bg-white rounded-full p-1.5 shadow-md border border-slate-100" title="AI Enhanced">
                                    <Sparkles size={16} className="text-yellow-500 fill-yellow-500" />
                                </div>
                            </div>
                            <h1 className="text-4xl md:text-5xl font-extrabold text-slate-900 mb-4 tracking-tight">
                                {portfolioData.personal.name}
                            </h1>
                            <p className="text-xl md:text-2xl text-slate-700 font-medium mb-4">
                                {portfolioData.personal.title}
                            </p>
                            <p className="text-slate-500 text-lg mb-8 max-w-2xl mx-auto leading-relaxed">
                                {portfolioData.personal.tagline}
                            </p>

                            <div className="flex justify-center gap-4">
                                <a href={portfolioData.personal.github} target="_blank" className="p-3 bg-white text-slate-700 rounded-full shadow-sm border border-slate-200 hover:bg-slate-800 hover:text-white hover:border-slate-800 transition-all duration-300">
                                    <Github size={20} />
                                </a>
                                <a href={portfolioData.personal.linkedin} target="_blank" className="p-3 bg-white text-slate-700 rounded-full shadow-sm border border-slate-200 hover:bg-[#0077b5] hover:text-white hover:border-[#0077b5] transition-all duration-300">
                                    <Linkedin size={20} />
                                </a>
                                <a href={`mailto:${portfolioData.personal.email}`} className="p-3 bg-white text-slate-700 rounded-full shadow-sm border border-slate-200 hover:bg-blue-600 hover:text-white hover:border-blue-600 transition-all duration-300">
                                    <Mail size={20} />
                                </a>
                            </div>
                        </div>

                        <div className="flex justify-center mt-16 animate-bounce text-slate-400">
                            <ChevronDown size={24} />
                        </div>
                    </header>

                    <main className="max-w-4xl mx-auto px-6 pb-24 space-y-24">

                        {/* 个人简介 */}
                        <section id="about" className="scroll-mt-24 fade-in-up" style={{ animationDelay: '0.2s' }}>
                            <SectionTitle icon={BookOpen} title="关于我" />
                            <Card className="leading-7 text-lg relative overflow-hidden">
                                {portfolioData.about}
                                <div className="absolute top-0 right-0 p-4 opacity-5">
                                    <BookOpen size={100} />
                                </div>
                            </Card>
                        </section>

                        {/* 个人经历 */}
                        <section id="experience" className="scroll-mt-24 fade-in-up" style={{ animationDelay: '0.3s' }}>
                            <SectionTitle icon={Briefcase} title="工作与经历" />
                            <div className="space-y-6 pl-4 border-l-2 border-slate-200">
                                {portfolioData.experience.map((job, index) => (
                                    <div key={index} className="relative pl-8 group">
                                        <div className="absolute -left-[9px] top-2 w-4 h-4 rounded-full bg-white border-4 border-blue-200 group-hover:border-blue-500 transition-colors duration-300"></div>
                                        <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition-shadow">
                                            <div className="flex flex-col md:flex-row md:justify-between md:items-center mb-2">
                                                <h3 className="text-xl font-bold text-slate-800">{job.role}</h3>
                                                <span className="text-sm font-medium text-slate-400 bg-slate-50 px-3 py-1 rounded-full">{job.period}</span>
                                            </div>
                                            <div className="text-blue-600 font-medium mb-3">{job.company}</div>
                                            <p className="text-slate-600 leading-relaxed">{job.description}</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </section>

                        {/* 研究方向/项目 */}
                        <section id="research" className="scroll-mt-24 fade-in-up" style={{ animationDelay: '0.4s' }}>
                            <SectionTitle icon={Microscope} title="研究方向" />
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                {portfolioData.research.map((item, index) => (
                                    <ResearchCard key={index} item={item} />
                                ))}
                            </div>
                        </section>

                        {/* 联系方式 */}
                        <section id="contact" className="scroll-mt-24 fade-in-up" style={{ animationDelay: '0.5s' }}>
                            <div className="bg-slate-900 rounded-3xl p-8 md:p-12 text-center text-white shadow-2xl relative overflow-hidden">
                                {/* 装饰圆环 */}
                                <div className="absolute top-0 right-0 w-64 h-64 bg-white/5 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"></div>
                                <div className="absolute bottom-0 left-0 w-64 h-64 bg-blue-500/10 rounded-full blur-3xl translate-y-1/2 -translate-x-1/2"></div>

                                <h2 className="text-3xl font-bold mb-4 relative z-10">有兴趣合作吗？</h2>
                                <p className="text-slate-400 mb-8 max-w-xl mx-auto relative z-10">
                                    如果您对我的研究感兴趣，或者有任何潜在的合作机会，欢迎随时通过邮件与我联系。
                                </p>
                                <a
                                    href={`mailto:${portfolioData.personal.email}`}
                                    className="inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-500 text-white font-semibold py-3 px-8 rounded-full transition-all duration-300 transform hover:scale-105 shadow-lg shadow-blue-600/30 relative z-10"
                                >
                                    <Mail size={18} />
                                    发送邮件
                                </a>
                                <div className="mt-12 pt-8 border-t border-slate-800 flex flex-col md:flex-row justify-between items-center text-sm text-slate-500 relative z-10">
                                    <div className="flex items-center gap-2 mb-4 md:mb-0">
                                        <MapPin size={16} />
                                        {portfolioData.personal.location}
                                    </div>
                                    <div>
                                        © {new Date().getFullYear()} {portfolioData.personal.name}. All rights reserved.
                                    </div>
                                </div>
                            </div>
                        </section>

                    </main>

                    {/* Chat Widget */}
                    <ChatWidget />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>